<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Showdown Camp</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bracket-bg: #333;
    --bracket-line: #666;
    --bracket-text: #eee;
    --card-bg: #444;
    --card-border: #888;
    --winner-color: #ffcb05;
    --loser-color: #999;
  }

  body {
    font-family: 'Poppins', sans-serif;
    margin: 0; padding: 0;
    background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
    min-height: 100vh;
  }

  .container {
    max-width: 1100px;
    margin: 20px auto;
    background: #fefefe;
    padding: 15px;
    border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.2);
  }

  h1, h2 { text-align: center; color: #333; font-family: 'Press Start 2P', cursive; }
  input, button, textarea, select { display: block; width: 100%; margin: 10px 0; padding: 12px; border-radius: 12px; border: 1px solid #ccc; font-size: 1rem; box-sizing: border-box; }
  button { background-color: #ffcb05; color: #3b4cca; font-weight: bold; border: 2px solid #3b4cca; cursor: pointer; transition: all 0.3s ease; }
  button:hover { background-color: #f5b700; transform: scale(1.05); }
  button:disabled { background-color: #ccc; cursor: not-allowed; }
  .hidden { display: none !important; }

  /* Trainer Card */
  .trainer-card {
    background: radial-gradient(circle at 30% 30%, #f5f5f5 0%, #fff8e1 100%);
    border: 4px solid #3b4cca;
    border-radius: 30px;
    padding: 20px;
    max-width: 400px;
    margin: 20px auto;
    text-align: center;
    box-shadow: 0 12px 25px rgba(0,0,0,0.4);
    position: relative;
    overflow: hidden;
  }

  .trainer-header {
    display: flex; flex-direction: column; align-items: center; gap: 12px;
  }

  .trainer-card img {
    border-radius: 50%;
    width: 120px; height: 120px;
    border: 3px solid #ff1f1f;
    background: #fff;
  }

  .trainer-card h3 {
    color: #3b4cca;
    margin: 0;
    font-family: 'Press Start 2P', cursive;
    font-size: 1rem;
  }
  .trainer-card p {
    margin: 5px 0;
    font-weight: bold;
    color: #333;
  }
  .progress-bar-container {
    width: 100%;
    background-color: #ddd;
    border-radius: 10px;
    margin: 10px 0;
    position: relative;
    height: 20px;
  }
  .progress-bar {
    height: 20px;
    background-color: #4CAF50;
    border-radius: 10px;
    text-align: right;
    color: white;
    font-weight: bold;
    font-size: 0.8rem;
    line-height: 20px;
    transition: width 0.5s ease-in-out;
    padding-right: 5px;
    white-space: nowrap;
    overflow: hidden;
  }
  .progress-text {
    position: absolute;
    width: 100%;
    text-align: center;
    font-size: 0.8rem;
    line-height: 20px;
    color: #333;
  }

  .card-pokemon {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-top: 15px;
  }

  .pokemon-box {
    position: relative;
    display: inline-block;
  }
  .pokemon-box img {
    width: 60px; height: 60px;
    background: #f5f5f5;
    border: 2px solid #3b4cca;
    border-radius: 12px;
    padding: 3px;
  }
  .remove-btn {
    position: absolute;
    top: -6px;
    right: -6px;
    background: #ff1f1f;
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 18px;
    height: 18px;
    font-size: 12px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    line-height: 15px;
    text-align: center;
    transition: transform 0.2s, background 0.2s;
  }
  .remove-btn:hover {
    background: #d62828;
    transform: scale(1.1);
  }

  #card-championships { margin-top: 15px; font-weight: bold; color: #d62828; }

  #suggestions { border: 1px solid #ccc; max-height: 150px; overflow-y: auto; cursor: pointer; background: #fff; border-radius: 8px; position: absolute; z-index: 1000; width: calc(100% - 26px); }
  #suggestions div:hover { background:#eee; }

  /* Novo estilo de Chaveamento */
  .bracket-container {
    background: var(--bracket-bg);
    color: var(--bracket-text);
    padding: 20px;
    border-radius: 15px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    white-space: nowrap;
  }
  .bracket-heading {
    text-align: center;
    font-size: 1.5rem;
    font-family: 'Press Start 2P', cursive;
    margin-bottom: 20px;
  }
  .bracket-rounds {
    display: inline-flex;
    gap: 30px;
    justify-content: center;
    align-items: center;
    padding: 20px 0;
  }
  .bracket-round {
    display: flex;
    flex-direction: column;
    gap: 20px;
    position: relative;
    vertical-align: top;
    white-space: normal;
  }
  .round-heading {
    text-align: center;
    font-weight: bold;
    margin-bottom: 10px;
  }
  .bracket-matchup {
    position: relative;
    padding: 10px;
    border-radius: 8px;
    background: var(--card-bg);
    border: 2px solid var(--card-border);
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    min-width: 180px;
    text-align: left;
  }
  .bracket-player {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9rem;
    padding: 3px 0;
  }
  .bracket-player.is-winner {
    font-weight: bold;
    color: var(--winner-color);
  }
  .bracket-player.is-loser {
    color: var(--loser-color);
  }
  .match-score {
    text-align: center;
    font-weight: bold;
    margin: 4px 0;
    font-size: 1.1rem;
  }
  .games-history {
    font-size: 0.75rem;
    border-top: 1px solid var(--bracket-line);
    margin-top: 5px;
    padding-top: 5px;
  }
  .games-history div {
    margin-bottom: 2px;
  }
  .bracket-line {
    position: absolute;
    border-right: 2px solid var(--bracket-line);
    border-top: 2px solid var(--bracket-line);
    content: '';
  }
  .bracket-line.top-line {
    right: -15px;
    top: calc(50% - 1px);
    height: 15px;
    width: 15px;
  }
  .bracket-line.bottom-line {
    right: -15px;
    top: calc(50% - 1px);
    height: 15px;
    width: 15px;
    border-top: none;
    border-bottom: 2px solid var(--bracket-line);
  }
  .player-btn {
    cursor: pointer;
    font-size: 0.8rem;
    color: #ffcb05;
    background: none;
    border: none;
    padding: 5px;
    border-radius: 5px;
    transition: all 0.2s;
  }
  .player-btn:hover {
    background: rgba(255, 203, 5, 0.2);
  }
  
  /* Estilo da lista de torneios */
  .champ-list-card {
    padding: 15px;
    background: #f0f0f0;
    margin-bottom: 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s, transform 0.2s;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
  .champ-list-card:hover {
    background: #e0e0e0;
    transform: translateY(-2px);
  }
  .champ-list-card.featured {
    border: 2px solid var(--winner-color);
    box-shadow: 0 6px 12px rgba(255, 203, 5, 0.3);
  }
  .champ-list-card h4 {
    margin: 0;
    color: #3b4cca;
  }
  .champ-list-card p {
    margin: 5px 0 0;
    font-size: 0.9rem;
    color: #555;
  }
  .champ-list-card .status {
    font-size: 0.8rem;
    font-weight: bold;
    color: #fff;
    padding: 2px 8px;
    border-radius: 10px;
    text-transform: uppercase;
  }
  .status.open { background-color: #28a745; }
  .status.in-progress { background-color: #ffc107; }
  .status.finished { background-color: #dc3545; }


  /* Tabbed Navigation */
  .tab-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 20px;
  }
  .tab-buttons button {
    width: auto;
    flex: 1;
    font-size: 0.8rem;
    padding: 10px 15px;
    background-color: #e9ecef;
    color: #495057;
    border: 1px solid #dee2e6;
  }
  .tab-buttons button.active {
    background-color: #ffcb05;
    color: #3b4cca;
    border-color: #3b4cca;
  }
  #ranking-list li, #badge-ranking-list li, .search-result-item {
    background: #f8f9fa;
    padding: 10px;
    margin-bottom: 5px;
    border-radius: 5px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    cursor: pointer;
    transition: background 0.2s, transform 0.2s;
  }
  #ranking-list li:hover, #badge-ranking-list li:hover, .search-result-item:hover {
    background: #e0e0e0;
    transform: translateY(-2px);
  }
  .sub-tab-buttons {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid #ccc;
    width: fit-content;
    margin-left: auto;
    margin-right: auto;
  }
  .sub-tab-buttons button {
    background-color: #f8f9fa;
    color: #333;
    border: none;
    padding: 8px 16px;
    cursor: pointer;
    transition: background-color 0.2s;
    margin: 0;
    border-radius: 0;
    font-size: 0.9rem;
    width: auto;
    flex-grow: 1;
  }
  .sub-tab-buttons button:not(:last-child) {
    border-right: 1px solid #ccc;
  }
  .sub-tab-buttons button.active {
    background-color: #ffcb05;
    color: #3b4cca;
    font-weight: bold;
  }

  /* Novo layout de perfil */
  .profile-layout {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
  }
  .profile-section-card {
    background: #f8f8f8;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    flex: 1 1 300px;
  }
  
  /* Modal de Replay */
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  }
  .modal-content {
    background-color: #fff;
    padding: 30px;
    border-radius: 15px;
    max-width: 90%;
    width: 400px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    text-align: center;
  }
  .modal-content h3 {
    margin-top: 0;
    font-family: 'Press Start 2P', cursive;
  }
  .modal-buttons {
    display: flex;
    justify-content: space-between;
    gap: 10px;
  }
  .modal-buttons button {
    flex: 1;
  }
  
  /* Layout de busca de usuário */
  #user-search-container {
    margin-bottom: 20px;
  }
  #search-results-list {
    margin-top: 15px;
  }
  .search-result-item {
    background: #f8f9fa;
    padding: 10px;
    margin-bottom: 5px;
    border-radius: 5px;
    font-weight: bold;
    display: flex;
    justify-content: space-between;
    cursor: pointer;
  }
  #user-profile-details-view .trainer-card {
    margin-top: 0;
  }

  /* Nomes dos jogadores no chaveamento que são links */
  .player-name-link {
    cursor: pointer;
    transition: color 0.2s;
  }
  .player-name-link:hover {
    color: #ffcb05;
    text-decoration: underline;
  }

  .badge-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-top: 15px;
  }
  .badge-item {
    position: relative;
    text-align: center;
    font-weight: bold;
    background: #e9ecef;
    padding: 5px 10px;
    border-radius: 8px;
  }
  .remove-badge-btn {
    position: absolute;
    top: -8px;
    right: -8px;
    background: #ff1f1f;
    color: white;
    border: none;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    font-size: 12px;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
    transition: transform 0.2s, background-color 0.2s;
  }
  .remove-badge-btn:hover {
    background-color: #c0392b;
    transform: scale(1.1);
  }

  .social-links a {
    display: block;
    margin-top: 5px;
    color: #3b4cca;
    text-decoration: none;
    font-weight: bold;
    transition: color 0.2s;
  }
  .social-links a:hover {
    color: #ffcb05;
  }
  
  .champ-list-card.gym-tournament {
    border: 3px solid #ffcb05;
    box-shadow: 0 4px 8px rgba(255, 203, 5, 0.4);
    background: #fff8e1;
  }

  #all-championships-list-gym-active h4,
  #all-championships-list-gym-finished h4 {
    color: #c39a00;
  }

  .pokemon-search-container {
    position: relative;
    display: block;
  }
  .pokemon-search-container input {
    margin-bottom: 0;
  }
  .pokemon-search-container #suggestions {
    position: absolute;
    width: calc(100% - 2px);
    top: 100%;
    left: 0;
    z-index: 10;
    border-top: none;
  }
  
  .profile-buttons {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
  }

  /* Estilo para a nova lista de jogadores e botão de remover */
  #champ-details-players ul {
    list-style: none;
    padding: 0;
    margin-top: 10px;
  }
  #champ-details-players li {
    background-color: #f8f9fa;
    padding: 8px 12px;
    border-radius: 6px;
    margin-bottom: 5px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .remove-player-btn {
    background-color: #e74c3c;
    color: white;
    border: none;
    border-radius: 50%;
    width: 22px;
    height: 22px;
    line-height: 22px;
    padding: 0;
    font-size: 12px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  .remove-player-btn:hover {
    background-color: #c0392b;
  }
  .player-list-container {
    border: 1px solid #ddd;
    border-radius: 8px;
    margin-top: 10px;
    overflow: hidden;
  }
  .player-list-header {
    background-color: #f0f0f0;
    padding: 10px 15px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 600;
  }
  .player-list-header:hover {
    background-color: #e0e0e0;
  }
  #player-list-toggle-icon {
    transition: transform 0.2s ease-in-out;
  }
  #champ-details-players {
    padding: 5px 15px 15px 15px;
    border-top: 1px solid #ddd;
  }
  #badge-selection-list .badge-option {
    background-color: #f0f0f0;
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.2s, transform 0.2s;
    border: 1px solid #ddd;
  }
  #badge-selection-list .badge-option:hover {
    background-color: #e0e0e0;
    transform: scale(1.03);
  }

  .user-stats {
    display: flex;
    justify-content: space-around;
    text-align: center;
    background-color: #f1f1f1;
    padding: 10px;
    border-radius: 8px;
    margin-top: 15px;
  }
  .user-stats div {
    flex: 1;
  }
  .user-stats .stat-value {
    display: block;
    font-size: 1.2rem;
    font-weight: bold;
    color: #3b4cca;
  }
  .user-stats .stat-label {
    font-size: 0.8rem;
    color: #555;
  }
  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: -10px;
  }
  .top-bar h1 {
    flex-grow: 1;
    text-align: center;
    margin: 0;
  }
  .top-bar .controls {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .top-bar .controls button {
      width: auto;
      padding: 8px 12px;
      font-size: 0.8rem;
  }
  #notification-bell {
    font-size: 1.2rem; /* Aumenta o sino */
    cursor: pointer;
    position: relative;
    border: none;
    background: none;
    color: #333;
    padding: 5px;
    width: auto;
    line-height: 1;
  }
  #notification-bell .dot {
    position: absolute;
    top: 2px;
    right: 2px;
    width: 8px;
    height: 8px;
    background-color: red;
    border-radius: 50%;
  }
  #notification-modal .notification-item {
    padding: 10px;
    border-bottom: 1px solid #eee;
    text-align: left;
  }
  #notification-modal .notification-item:last-child {
    border-bottom: none;
  }


  @media (max-width: 600px) {
    .container {
      padding: 10px;
      margin: 10px auto;
    }
    h1 { font-size: 1.2rem; }
    h2 { font-size: 1rem; }
    .tab-buttons { flex-wrap: wrap; }
    .tab-buttons button { font-size: 0.7rem; padding: 8px; }
    .bracket-container { white-space: normal; }
    .bracket-rounds { display: block; }
    .bracket-round { margin-bottom: 20px; }
    .top-bar h1 {
        font-size: 1rem;
    }
  }
</style>
</head>
<body>
<div class="container">

  <div id="login-screen">
    <h1>Showdown Camp</h1>
    <h2>Login</h2>
    <input type="text" id="login-username" placeholder="Usuário">
    <input type="password" id="login-password" placeholder="Senha">
    <button onclick="login()">Entrar</button>
    <h2>Cadastro</h2>
    <input type="text" id="signup-username" placeholder="Novo usuário">
    <input type="password" id="signup-password" placeholder="Nova senha">
    <button onclick="signup()">Cadastrar</button>
  </div>

  <div id="user-screen" class="hidden">
    <div class="top-bar">
      <h1>Bem-vindo, <span id="user-display"></span>!</h1>
      <div class="controls">
        <button id="notification-bell" onclick="showNotificationModal()">🔔</button>
        <button onclick="logout()">Logout</button>
      </div>
    </div>
    

    <div class="tab-buttons">
      <button onclick="showTab('profile')">Meu Perfil</button>
      <button onclick="showTab('my-tournaments')">Meus Torneios</button>
      <button onclick="showTab('all-tournaments')">Torneios Ativos</button>
      <button onclick="showTab('leaderboard')">Ranking Global</button>
      <button id="admin-tab-btn" class="hidden" onclick="showTab('admin-panel')">Painel Admin</button>
    </div>
    
    <div id="profile-tab" class="tab-content hidden">
      <div class="profile-layout">
        
        <div class="profile-section-card">
          <h2>Meu Perfil</h2>
          <div id="profile-display-section">
            <div class="trainer-card" id="trainer-card">
              <div class="trainer-header">
                <img id="card-image" src="https://via.placeholder.com/120" alt="Treinador">
                <h3 id="card-name"></h3>
                <p>Nível: <span id="card-level"></span></p>
                <div class="progress-bar-container">
                  <div class="progress-bar" id="level-progress-bar"></div>
                </div>
                <p>Pontos: <span id="card-points"></span></p>
                <div class="social-links" id="profile-display-socials"></div>
              </div>
            </div>
            <div id="my-user-stats" class="user-stats"></div>
            <div class="profile-buttons">
              <button onclick="toggleEditProfile(true)">Editar Perfil</button>
            </div>
          </div>
          
          <div id="profile-edit-section" class="hidden">
            <input type="text" id="player-name" placeholder="Nome do treinador">
            <input type="text" id="player-image" placeholder="URL da imagem do treinador">
            <textarea id="bio-textarea" placeholder="Sua biografia" rows="4"></textarea>
            <input type="text" id="twitter-input" placeholder="Link do Twitter">
            <input type="text" id="discord-input" placeholder="ID do Discord">
            <div class="profile-buttons">
              <button onclick="saveProfile()">Salvar Perfil</button>
              <button onclick="toggleEditProfile(false)">Cancelar</button>
            </div>
          </div>
        </div>

        <div class="profile-section-card">
          <h2>Meus Pokémon Favoritos</h2>
          <label>Adicionar Pokémon:</label>
          <div class="pokemon-search-container">
            <input type="text" id="pokemon-search" placeholder="Pesquise Pokémon">
            <div id="suggestions"></div>
          </div>
          <div class="card-pokemon" id="card-pokemons-card"></div>
        </div>

        <div class="profile-section-card">
          <h2>Insígnias de Ginásio</h2>
          <div class="badge-list" id="my-badges-list"></div>
        </div>

      </div>
    </div>

    <div id="my-tournaments-tab" class="tab-content hidden">
      <h2>Criar Campeonato</h2>
      <input type="text" id="championship-name" placeholder="Nome do campeonato">
      <textarea id="championship-rules" placeholder="Regras do campeonato"></textarea>
      <input type="date" id="championship-date">
      <input type="number" id="championship-max" placeholder="Máx. participantes">
      <label for="championship-format">Formato do Torneio:</label>
      <select id="championship-format">
          <option value="bo1" selected>Eliminatória Simples (MD1)</option>
          <option value="bo3">Melhor de 3 (MD3)</option>
      </select>
      <button onclick="createChampionship()">Criar Campeonato</button>
      <h3>Meus Torneios</h3>
      <div id="my-championships-list-active"></div>
      <h3>Torneios Finalizados</h3>
      <div id="my-championships-list-finished"></div>
    </div>
    
    <div id="all-tournaments-tab" class="tab-content hidden">
      <h3>Torneios de Ginásio</h3>
      <div id="all-championships-list-gym-active"></div>
      <h3>Outros Torneios Ativos</h3>
      <div id="all-championships-list-active"></div>
      <hr>
      <h3>Torneios Finalizados</h3>
      <div id="all-championships-list-gym-finished"></div>
      <div id="all-championships-list-finished"></div>
    </div>

    <div id="leaderboard-tab" class="tab-content hidden">
      <h3>Ranking Global</h3>
      
      <div class="sub-tab-buttons">
        <button id="rank-points-btn" class="active" onclick="showRanking('points')">Por Pontos</button>
        <button id="rank-badges-btn" onclick="showRanking('badges')">Por Insígnias</button>
      </div>

      <div id="points-ranking-view">
          <ol id="ranking-list"></ol>
      </div>

      <div id="badges-ranking-view" class="hidden">
          <ol id="badge-ranking-list"></ol>
      </div>

      <div id="user-search-container">
        <h3>Buscar Usuário</h3>
        <input type="text" id="user-search-input" placeholder="Pesquisar por nome ou usuário">
        <div id="search-results-list"></div>
      </div>
    </div>

    <div id="admin-panel-tab" class="tab-content hidden">
      <h2>Painel de Administração</h2>
      <h3>Gerenciar Usuários</h3>
      <div id="user-list-admin"></div>
      <hr>
      <h3>Enviar Notificação Global</h3>
      <textarea id="global-notification-message" rows="4" placeholder="Sua mensagem para todos os usuários..."></textarea>
      <button onclick="sendGlobalNotification()">Enviar para Todos</button>
    </div>

    <div id="championship-details-view" class="hidden">
      <button onclick="goBackToList()">Voltar para a lista</button>
      <div class="champ-card">
        <h3 id="champ-details-name"></h3>
        <p><strong>Status:</strong> <span id="champ-details-status"></span></p>
        <p><strong>Criador:</strong> <span id="champ-details-owner"></span></p>
        <p><strong>Data:</strong> <span id="champ-details-date"></span></p>
        <p><strong>Formato:</strong> <span id="champ-details-format"></span></p>
        <p><strong>Regras:</strong> <span id="champ-details-rules"></span></p>
        
        <div class="player-list-container">
            <div class="player-list-header" onclick="togglePlayerList()">
                <strong>Jogadores (<span id="champ-details-count"></span>/<span id="champ-details-max"></span>)</strong>
                <span id="player-list-toggle-icon">▼</span>
            </div>
            <div id="champ-details-players" class="hidden"></div>
        </div>

        <button id="join-btn" onclick="">Entrar</button>
        <button id="bracket-btn" onclick="">Sortear Chaveamento</button>
        <button id="delete-btn" onclick="">Excluir</button>
        <button id="feature-btn" class="hidden" onclick="">Destacar</button>
      </div>
      <div id="championship-bracket-container"></div>
    </div>

    <div id="user-profile-details-view" class="hidden">
        <button onclick="goBackFromProfile()">Voltar</button>
        <div class="profile-layout">
            <div class="profile-section-card">
                <h2>Perfil do Jogador</h2>
                <div class="trainer-card">
                    <div class="trainer-header">
                        <img id="other-user-card-image" src="https://via.placeholder.com/120" alt="Treinador">
                        <h3 id="other-user-card-name"></h3>
                        <p>Nível: <span id="other-user-card-level"></span></p>
                        <p>Pontos: <span id="other-user-card-points"></span></p>
                        <div class="social-links" id="other-user-socials"></div>
                    </div>
                </div>

                <div class="user-stats" id="other-user-stats"></div>

                <p><strong>Biografia:</strong> <span id="other-user-bio"></span></p>
            </div>
            <div class="profile-section-card">
                <h2>Pokémon Favoritos</h2>
                <div class="card-pokemon" id="other-user-card-pokemons"></div>
            </div>
            <div class="profile-section-card">
                <h2>Insígnias de Ginásio</h2>
                <div class="badge-list" id="other-badges-list"></div>
                <button id="add-badge-btn" class="hidden" style="margin-top: 20px;">Adicionar Insígnia</button>
            </div>
        </div>
    </div>
  </div>
</div>

<div id="winner-modal" class="modal-overlay hidden">
  <div class="modal-content">
    <h3 id="modal-title"></h3>
    <input type="url" id="replay-link" placeholder="Link do Replay (opcional)">
    <div class="modal-buttons">
      <button onclick="confirmWinner()">Confirmar Vitória</button>
      <button onclick="hideWinnerModal()">Cancelar</button>
    </div>
  </div>
</div>

<div id="badge-modal" class="modal-overlay hidden">
  <div class="modal-content">
    <h3>Conceder Insígnia</h3>
    <div id="badge-selection-list"></div>
    <button onclick="hideBadgeModal()" style="margin-top: 20px; background-color: #f1f1f1; color: #333;">Cancelar</button>
  </div>
</div>

<div id="notification-modal" class="modal-overlay hidden">
  <div class="modal-content">
    <h3>Notificações</h3>
    <div id="notification-list"></div>
    <button onclick="hideNotificationModal()" style="margin-top: 20px; background-color: #f1f1f1; color: #333;">Fechar</button>
  </div>
</div>

<script type="module">
  // Firebase SDKs
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, collection, query, where, getDocs, updateDoc, arrayUnion, arrayRemove, addDoc, deleteDoc, increment, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.10.0/firebase-firestore.js";

  // Configuração do Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyASjpqLbD2a5zFdsXLAErFa5324ecJsIYY",
    authDomain: "showdown-camp.firebaseapp.com",
    projectId: "showdown-camp",
    storageBucket: "showdown-camp.appspot.com",
    messagingSenderId: "340772186713",
    appId: "1:340772186713:web:e23ba55d58ed95ed561f48"
  };

  // Inicialize o Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // Variáveis globais
  let allPokemons = [];
  const LEVEL_THRESHOLDS = {
    1: 0, 2: 100, 3: 250, 4: 500, 5: 1000,
    6: 2000, 7: 4000, 8: 8000, 9: 16000, 10: 32000
  };

  const GYM_BADGES = [
    'Rocha', 'Cascata', 'Trovão', 'Arco-Íris', 'Alma', 'Marsh', 'Vulcão', 'Terra'
  ];

  let currentWinnerChampId, currentWinnerRound, currentWinnerBattle, currentWinnerUid;
  let previousTab = 'profile';
  let currentUserId = null;
  let allUsersData = {};
  let viewingUserUid = null;

  async function loadAllPokemons() {
    try {
        const response = await fetch('https://pokeapi.co/api/v2/pokemon?limit=2000');
        const data = await response.json();
        allPokemons = data.results.map(p => capitalize(p.name));
    } catch (error) {
        console.error("Erro ao carregar lista de Pokémon:", error);
    }
  }
  
  function capitalize(str){ return str.charAt(0).toUpperCase()+str.slice(1); }

  const pokemonSearchInput = document.getElementById('pokemon-search');
  const pokemonSuggestionsDiv = document.getElementById('suggestions');

  pokemonSearchInput.addEventListener('input', function(){
    const value = this.value.toLowerCase();
    pokemonSuggestionsDiv.innerHTML='';
    if(!value) return;
    const matches = allPokemons.filter(p => p.toLowerCase().startsWith(value)).slice(0,10);
    matches.forEach(p=>{
      const div = document.createElement('div');
      div.innerText = p;
      div.onclick = ()=>addPokemon(p);
      pokemonSuggestionsDiv.appendChild(div);
    });
  });

  async function addPokemon(name){
    if (!currentUserId) return;
    pokemonSuggestionsDiv.innerHTML='';
    pokemonSearchInput.value='';
    
    const userDocRef = doc(db, 'users', currentUserId);
    const user = allUsersData[currentUserId];
    
    if(user && !user.profile.pokemons.includes(name)){
        await updateDoc(userDocRef, {
            "profile.pokemons": arrayUnion(name)
        });
        await loadProfile();
    }
  }

  async function removePokemon(name){
    if (!currentUserId) return;
    const userDocRef = doc(db, 'users', currentUserId);
    await updateDoc(userDocRef, {
        "profile.pokemons": arrayRemove(name)
    });
    await loadProfile();
  }

  async function signup(){
    const username = document.getElementById('signup-username').value.trim();
    const password = document.getElementById('signup-password').value.trim();
    const email = username + "@showdown.com"; 
    if(!username||!password){alert("Preencha todos os campos!"); return;}
    
    const q = query(collection(db, "users"), where("username", "==", username));
    const querySnapshot = await getDocs(q);
    if (!querySnapshot.empty) {
        alert("Usuário já existe!");
        return;
    }

    try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        
        const isAdmin = username === 'frogar';

        await setDoc(doc(db, "users", user.uid), {
            username: username,
            profile:{ name: username, trainerImage:'', pokemons:[], bio: '', twitter: '', discord: '' },
            points: 0,
            level: 1,
            isAdmin: isAdmin,
            badges: [],
            wins: 0,
            losses: 0,
            tournamentsPlayed: 0,
            titlesWon: 0,
            notifications: []
        });

        alert("Usuário cadastrado com sucesso!");
    } catch (error) {
        alert("Erro ao cadastrar: " + error.message);
    }
  }

  async function login(){
    const username = document.getElementById('login-username').value.trim();
    const password = document.getElementById('login-password').value.trim();
    const email = username + "@showdown.com";
    
    try {
        await signInWithEmailAndPassword(auth, email, password);
    } catch (error) {
        alert("Usuário ou senha incorretos! Detalhe: " + error.message);
    }
  }

  function logout(){
    signOut(auth);
  }

  async function showUserScreen(uid){
    currentUserId = uid;
    const userDocRef = doc(db, "users", uid);
    const userDoc = await getDoc(userDocRef);
    if (!userDoc.exists()) {
      console.error("Documento do usuário não encontrado.");
      return;
    }
    const user = userDoc.data();
    allUsersData[uid] = { uid, ...user };
    
    document.getElementById('user-display').innerText = user.username;
    document.getElementById('login-screen').classList.add('hidden');
    document.getElementById('user-screen').classList.remove('hidden');
    
    if (user.isAdmin) {
      document.getElementById('admin-tab-btn').classList.remove('hidden');
    } else {
      document.getElementById('admin-tab-btn').classList.add('hidden');
    }
    
    checkNotifications();
    await loadProfile();
    showTab('profile');
  }

  function showTab(tabName) {
    const tabs = document.querySelectorAll('.tab-content, #championship-details-view, #user-profile-details-view');
    tabs.forEach(tab => tab.classList.add('hidden'));

    const buttons = document.querySelectorAll('.tab-buttons button');
    buttons.forEach(btn => btn.classList.remove('active'));

    const currentTab = document.getElementById(tabName + '-tab');
    if (currentTab) {
      currentTab.classList.remove('hidden');
    }
    const activeTabBtn = document.querySelector(`.tab-buttons button[onclick="showTab('${tabName}')"]`);
    if (activeTabBtn) {
      activeTabBtn.classList.add('active');
    }

    previousTab = tabName;

    if (tabName === 'all-tournaments') {
        loadAllChampionshipsList();
    } else if (tabName === 'my-tournaments') {
        loadMyChampionshipsList();
    } else if (tabName === 'leaderboard') {
        showRanking('points'); 
    } else if (tabName === 'admin-panel') {
        loadAdminPanel();
    }
  }

  async function saveProfile(){
    if (!currentUserId) return;
    const name = document.getElementById('player-name').value.trim();
    const trainerImage = document.getElementById('player-image').value.trim();
    const bio = document.getElementById('bio-textarea').value.trim();
    const twitter = document.getElementById('twitter-input').value.trim();
    const discord = document.getElementById('discord-input').value.trim();
    
    const userDocRef = doc(db, "users", currentUserId);
    await updateDoc(userDocRef, {
      "profile.name": name,
      "profile.trainerImage": trainerImage,
      "profile.bio": bio,
      "profile.twitter": twitter,
      "profile.discord": discord
    });
    
    alert("Perfil salvo!");
    await loadProfile();
    toggleEditProfile(false);
  }

  async function toggleEditProfile(showEdit) {
    document.getElementById('profile-display-section').classList.toggle('hidden', showEdit);
    document.getElementById('profile-edit-section').classList.toggle('hidden', !showEdit);
    
    if (showEdit) {
        if (!currentUserId) return;
        const user = allUsersData[currentUserId];
        if (user) {
            document.getElementById('player-name').value = user.profile.name || '';
            document.getElementById('player-image').value = user.profile.trainerImage || '';
            document.getElementById('bio-textarea').value = user.profile.bio || '';
            document.getElementById('twitter-input').value = user.profile.twitter || '';
            document.getElementById('discord-input').value = user.profile.discord || '';
        }
    }
  }
  
  function goBackFromProfile() {
    showTab(previousTab);
  }

  async function loadProfile() {
    if (!currentUserId) return;
    const userDocRef = doc(db, "users", currentUserId);
    const userDoc = await getDoc(userDocRef);
    if (!userDoc.exists()) return;
    const user = userDoc.data();
    
    allUsersData[currentUserId] = { uid: currentUserId, ...user }; 
    
    document.getElementById('card-name').innerText = user.profile.name || 'Treinador';
    document.getElementById('card-image').src = user.profile.trainerImage || 'https://via.placeholder.com/120';
    document.getElementById('card-points').innerText = user.points || 0;
    document.getElementById('card-level').innerText = user.level || 1;
    
    const statsDiv = document.getElementById('my-user-stats');
    statsDiv.innerHTML = `
      <div>
        <span class="stat-value">${user.wins || 0}V / ${user.losses || 0}D</span>
        <span class="stat-label">Vitórias/Derrotas</span>
      </div>
      <div>
        <span class="stat-value">${user.tournamentsPlayed || 0}</span>
        <span class="stat-label">Torneios</span>
      </div>
      <div>
        <span class="stat-value">${user.titlesWon || 0}</span>
        <span class="stat-label">Títulos</span>
      </div>
    `;

    const nextLevelPoints = LEVEL_THRESHOLDS[user.level + 1];
    const currentLevelPoints = LEVEL_THRESHOLDS[user.level] || 0;
    
    const progressBar = document.getElementById('level-progress-bar');
    if (nextLevelPoints !== undefined) {
      const progress = Math.min(100, Math.max(0, ((user.points - currentLevelPoints) / (nextLevelPoints - currentLevelPoints)) * 100));
      progressBar.style.width = progress + '%';
      progressBar.innerText = `${user.points} / ${nextLevelPoints} pts`;
    } else {
      progressBar.style.width = '100%';
      progressBar.innerText = `Nível Máximo!`;
    }

    const socialsDiv = document.getElementById('profile-display-socials');
    socialsDiv.innerHTML = '';
    if (user.profile.twitter) {
        const twitterLink = document.createElement('a');
        twitterLink.href = user.profile.twitter.startsWith('http') ? user.profile.twitter : `https://twitter.com/${user.profile.twitter}`;
        twitterLink.target = '_blank';
        twitterLink.innerText = `Twitter`;
        socialsDiv.appendChild(twitterLink);
    }
    if (user.profile.discord) {
        const discordP = document.createElement('p');
        discordP.innerHTML = `Discord: <strong>${user.profile.discord}</strong>`;
        socialsDiv.appendChild(discordP);
    }
    
    const badgesContainer = document.getElementById('my-badges-list');
    badgesContainer.innerHTML = '';
    if(user.badges && user.badges.length > 0) {
        user.badges.forEach(badgeName => {
            const badgeDiv = document.createElement('div');
            badgeDiv.className = 'badge-item';
            badgeDiv.innerHTML = `🏆 ${badgeName}`;
            badgesContainer.appendChild(badgeDiv);
        });
    }

    updatePokemonsCard(user.profile.pokemons);
  }

  function updatePokemonsCard(pokemons = []){
    const container = document.getElementById('card-pokemons-card');
    container.innerHTML = pokemons.map(p=>`
      <div class="pokemon-box">
        <img src="https://img.pokemondb.net/sprites/home/normal/${p.toLowerCase()}.png" alt="${p}">
        <button class="remove-btn" onclick="removePokemon('${p}')">×</button>
      </div>
    `).join('');
  }

  async function createChampionship(){
    const user = allUsersData[currentUserId];
    if(!user) return;

    const name=document.getElementById('championship-name').value.trim();
    const rules=document.getElementById('championship-rules').value.trim();
    const date=document.getElementById('championship-date').value;
    const max=parseInt(document.getElementById('championship-max').value);
    const format = document.getElementById('championship-format').value;
    if(!name||!rules||!date||!max){alert("Preencha todos os campos!");return;}
    
    const championship={
      name, rules, date, max, format,
      players: [currentUserId],
      owner: currentUserId,
      rounds:[], status: 'Open', 
      isGym: user.isAdmin,
      isFeatured: false
    };
    
    await addDoc(collection(db, "championships"), championship);
    
    alert("Campeonato criado!");
    showTab('all-tournaments');
  }

  async function removePlayerFromChampionship(champId, playerUid, playerName) {
    if (confirm(`Tem certeza que deseja remover o jogador "${playerName}" do torneio?`)) {
      try {
        const champDocRef = doc(db, 'championships', champId);
        await updateDoc(champDocRef, {
          players: arrayRemove(playerUid)
        });
        console.log(`Jogador ${playerName} removido com sucesso.`);
        await showChampionshipDetails(champId);
      } catch (error) {
        console.error("Erro ao remover jogador:", error);
        alert("Não foi possível remover o jogador. Verifique o console para mais detalhes.");
      }
    }
  }

  async function joinChampionship(champId){
    if(!currentUserId) return;
    
    const joinBtn = document.getElementById('join-btn');
    joinBtn.disabled = true;
    joinBtn.innerText = 'Entrando...';

    const champDocRef = doc(db, 'championships', champId);
    
    try {
        const champDoc = await getDoc(champDocRef);
        if (!champDoc.exists()) {
            alert("Erro: Campeonato não encontrado.");
            joinBtn.disabled = false;
            joinBtn.innerText = 'Entrar';
            return;
        }

        const c = champDoc.data();

        if(c.players.includes(currentUserId)){
            alert("Você já está nesse campeonato!");
            await showChampionshipDetails(champId);
            return;
        }
        if(c.players.length >= c.max){
            alert("Campeonato cheio!");
            await showChampionshipDetails(champId);
            return;
        }
        if(c.status !== 'Open'){
            alert("Este campeonato não está aberto para inscrições!");
            await showChampionshipDetails(champId);
            return;
        }
        
        await updateDoc(champDocRef, {
            players: arrayUnion(currentUserId)
        });

        await showChampionshipDetails(champId);

    } catch (error) {
        console.error("Erro ao entrar no campeonato:", error);
        alert("Ocorreu um erro ao tentar entrar no campeonato.");
        joinBtn.disabled = false;
        joinBtn.innerText = 'Entrar';
    }
  }

  async function drawBracket(champId){
    const bracketBtn = document.getElementById('bracket-btn');
    bracketBtn.disabled = true;
    bracketBtn.innerText = 'Sorteando...';

    try {
      const champDocRef = doc(db, 'championships', champId);
      const champDoc = await getDoc(champDocRef);
      if (!champDoc.exists()) throw new Error("Campeonato não encontrado.");

      const c = champDoc.data();
      
      const user = allUsersData[currentUserId];
      if (c.owner !== currentUserId && !user.isAdmin) {
        alert("Apenas o criador ou um administrador pode sortear!");
        return;
      }
      
      if(c.rounds.length > 0){
        alert("O chaveamento já foi sorteado.");
        return;
      }
      
      let players=[...c.players];
      if(players.length < 2){
        alert("São necessários no mínimo 2 jogadores para o sorteio!");
        return;
      }

      for (const playerId of players) {
          await updateDoc(doc(db, 'users', playerId), {
              tournamentsPlayed: increment(1)
          });
      }

      players.sort(()=>Math.random()-0.5);
      let firstRoundMatches=[];
      while(players.length>=2){
        firstRoundMatches.push({
            p1:players.pop(), 
            p2:players.pop(), 
            winner:null,
            p1Score: 0,
            p2Score: 0,
            games: []
        });
      }
      if(players.length===1){
        const luckyPlayer = players.pop();
        firstRoundMatches.push({
            p1: luckyPlayer, 
            p2: 'BYE', 
            winner: luckyPlayer, 
            p1Score: c.format === 'bo3' ? 2 : 1, 
            p2Score: 0, 
            games: []
        });
      }
      
      const firstRoundObject = { matches: firstRoundMatches };
      
      await updateDoc(champDocRef, {
        rounds: [firstRoundObject],
        status: 'In Progress'
      });
      
      await showChampionshipDetails(champId);
    } catch (error) {
      console.error("Erro ao sortear chaveamento:", error);
      alert("Ocorreu um erro ao sortear o chaveamento: " + error.message);
    } finally {
      bracketBtn.disabled = false;
      bracketBtn.innerText = 'Sortear Chaveamento';
    }
  }

  async function setWinner(champId, roundIndex, battleIndex, winnerUid, replayLink){
    try {
        const champDocRef = doc(db, 'championships', champId);
        const champDoc = await getDoc(champDocRef);
        if (!champDoc.exists()) throw new Error("Campeonato não encontrado.");

        const champ = champDoc.data();
        let battle = champ.rounds[roundIndex].matches[battleIndex];
        const loserUid = battle.p1 === winnerUid ? battle.p2 : battle.p1;
        
        const game = { winner: winnerUid, replay: replayLink || null };
        battle.games.push(game);

        if (winnerUid === battle.p1) {
            battle.p1Score++;
        } else {
            battle.p2Score++;
        }

        const isMatchOver = (champ.format === 'bo3' && (battle.p1Score === 2 || battle.p2Score === 2)) || (champ.format !== 'bo3' && battle.p1Score + battle.p2Score === 1);

        if (isMatchOver) {
            battle.winner = winnerUid;
            
            await updateDoc(doc(db, 'users', winnerUid), { wins: increment(1) });
            if (loserUid !== 'BYE') {
                await updateDoc(doc(db, 'users', loserUid), { losses: increment(1) });
            }

            if (!champ.isGym) {
                await updateDoc(doc(db, 'users', winnerUid), { points: increment(10) });
                await checkLevelUp(winnerUid);
            }
        }
        
        if(isMatchOver && champ.rounds[roundIndex].matches.every(b => b.winner)){
          let winners = champ.rounds[roundIndex].matches.map(b => b.winner);
          if(winners.length > 1){
            let nextRoundMatches = [];
            while(winners.length >= 2){
              nextRoundMatches.push({ p1: winners.shift(), p2: winners.shift(), winner: null, p1Score: 0, p2Score: 0, games: [] });
            }
            if (winners.length === 1) {
              const luckyPlayer = winners.shift();
              nextRoundMatches.push({ p1: luckyPlayer, p2: 'BYE', winner: luckyPlayer, p1Score: champ.format === 'bo3' ? 2 : 1, p2Score: 0, games: [] });
            }
            champ.rounds.push({ matches: nextRoundMatches });
            
            for (const match of nextRoundMatches) {
              if (match.p1 !== 'BYE' && match.p2 !== 'BYE') {
                const message1 = `Sua próxima batalha no torneio "${champ.name}" é contra ${allUsersData[match.p2]?.username}.`;
                const message2 = `Sua próxima batalha no torneio "${champ.name}" é contra ${allUsersData[match.p1]?.username}.`;
                await sendNotification(match.p1, message1);
                await sendNotification(match.p2, message2);
              }
            }

          } else {
            champ.status = 'Finished';
            const finalWinner = winners[0];
            
            if (!champ.isGym) {
              await updateDoc(doc(db, "users", finalWinner), { points: increment(50) });
            }
            await updateDoc(doc(db, "users", finalWinner), { titlesWon: increment(1) });
            alert(`O torneio ${champ.name} foi finalizado! O campeão é: ${allUsersData[finalWinner]?.profile.name || allUsersData[finalWinner]?.username}`);
          }
        }

        await updateDoc(champDocRef, { rounds: champ.rounds, status: champ.status });
        await loadAllUsersData(); 
        await showChampionshipDetails(champId);
        hideWinnerModal();
    } catch (error) {
        console.error("Erro ao definir vencedor:", error);
        alert("Ocorreu um erro ao definir o vencedor: " + error.message);
    }
  }

  function showWinnerModal(champId, roundIndex, battleIndex, winnerUid) {
    currentWinnerChampId = champId;
    currentWinnerRound = roundIndex;
    currentWinnerBattle = battleIndex;
    currentWinnerUid = winnerUid;

    const winnerName = allUsersData[winnerUid]?.profile.name || allUsersData[winnerUid]?.username;
    document.getElementById('modal-title').innerText = `Confirmar Vencedor do Jogo`;
    
    document.getElementById('winner-modal').classList.remove('hidden');
  }

  function hideWinnerModal() {
    document.getElementById('winner-modal').classList.add('hidden');
    document.getElementById('replay-link').value = '';
  }

  function confirmWinner() {
    const replayLink = document.getElementById('replay-link').value;
    setWinner(currentWinnerChampId, currentWinnerRound, currentWinnerBattle, currentWinnerUid, replayLink);
  }

  async function checkLevelUp(uid){
    const userDocRef = doc(db, "users", uid);
    const userDoc = await getDoc(userDocRef);
    const user = userDoc.data();
    
    let currentLevel = user.level || 1;
    let nextLevel = currentLevel + 1;
    
    while(LEVEL_THRESHOLDS[nextLevel] !== undefined && user.points >= LEVEL_THRESHOLDS[nextLevel]){
        currentLevel++;
        nextLevel++;
    }
    
    if (currentLevel > user.level) {
        await updateDoc(userDocRef, { level: currentLevel });
        alert(`Parabéns, ${user.profile.name || user.username}! Você subiu para o Nível ${currentLevel}!`);
    }
  }

  async function deleteChampionship(champId){
    const user = allUsersData[currentUserId];
    const champDocRef = doc(db, 'championships', champId);
    const champDoc = await getDoc(champDocRef);
    const champ = champDoc.data();

    if(currentUserId !== champ.owner && !(user && user.isAdmin)){
      alert("Apenas o criador ou um administrador pode excluir!");
      return;
    }
    
    if (confirm(`Tem certeza que deseja excluir o campeonato ${champ.name}?`)) {
        await deleteDoc(champDocRef);
        alert(`Campeonato ${champ.name} excluído.`);
        showTab('all-tournaments');
    }
  }
  
  function showChampionshipsList(listElement, championships) {
    listElement.innerHTML = '';
    if (championships.length === 0) {
      listElement.innerHTML = '<p>Nenhum torneio encontrado.</p>';
      return;
    }
    championships.forEach(c => {
      let li = document.createElement('div');
      li.className = `champ-list-card ${c.isFeatured ? 'featured' : ''}`;
      li.innerHTML = `
        <h4>${c.isFeatured ? '⭐' : ''} ${c.name} <span class="status ${c.status.toLowerCase()}">${c.status}</span></h4>
        <p>Criador: ${allUsersData[c.owner]?.profile.name || allUsersData[c.owner]?.username || 'Desconhecido'}</p>
        <p>Jogadores: ${c.players.length}/${c.max}</p>
      `;
      li.onclick = () => showChampionshipDetails(c.id);
      listElement.appendChild(li);
    });
  }

  async function loadAllChampionshipsList(){
    const q = query(collection(db, "championships"));
    const querySnapshot = await getDocs(q);
    
    let allChampionships = [];
    querySnapshot.forEach(doc => {
      allChampionships.push({ id: doc.id, ...doc.data() });
    });

    allChampionships.sort((a, b) => (b.isFeatured ? 1 : 0) - (a.isFeatured ? 1 : 0));

    const gymTournamentsActive = allChampionships.filter(c => c.isGym && (c.status === 'Open' || c.status === 'In Progress'));
    const activeTournaments = allChampionships.filter(c => !c.isGym && (c.status === 'Open' || c.status === 'In Progress'));
    const gymTournamentsFinished = allChampionships.filter(c => c.isGym && c.status === 'Finished');
    const finishedTournaments = allChampionships.filter(c => !c.isGym && c.status === 'Finished');

    showChampionshipsList(document.getElementById('all-championships-list-gym-active'), gymTournamentsActive);
    showChampionshipsList(document.getElementById('all-championships-list-active'), activeTournaments);
    showChampionshipsList(document.getElementById('all-championships-list-gym-finished'), gymTournamentsFinished);
    showChampionshipsList(document.getElementById('all-championships-list-finished'), finishedTournaments);
  }

  async function loadMyChampionshipsList(){
    if(!currentUserId) return;
    const q = query(collection(db, "championships"), where("players", "array-contains", currentUserId));
    const querySnapshot = await getDocs(q);
    
    let myChampionships = [];
    querySnapshot.forEach(doc => {
      myChampionships.push({ id: doc.id, ...doc.data() });
    });

    let activeList = document.getElementById('my-championships-list-active');
    let finishedList = document.getElementById('my-championships-list-finished');
    
    const activeChamps = myChampionships.filter(c => c.status === 'Open' || c.status === 'In Progress');
    const finishedChamps = myChampionships.filter(c => c.status === 'Finished');

    showChampionshipsList(activeList, activeChamps);
    showChampionshipsList(finishedList, finishedChamps);
  }
  
  async function loadPointsLeaderboard(){
    let allPlayers = Object.values(allUsersData);

    allPlayers.sort((a, b) => {
      if ((b.points || 0) !== (a.points || 0)) return (b.points || 0) - (a.points || 0);
      return (b.level || 1) - (a.level || 1);
    });

    let rankingList = document.getElementById('ranking-list');
    rankingList.innerHTML = '';
    
    allPlayers.slice(0, 10).forEach((player, index) => {
      let li = document.createElement('li');
      li.innerHTML = `<strong>${index + 1}.</strong> <span class="player-name-link" onclick="showUserProfileDetails('${player.uid}')">${player.profile.name || player.username}</span> <span>(Nível ${player.level || 1} - ${player.points || 0} pontos)</span>`;
      rankingList.appendChild(li);
    });
  }

  async function loadBadgeLeaderboard() {
    let allPlayers = Object.values(allUsersData);

    allPlayers.sort((a, b) => {
      const badgeCountB = b.badges ? b.badges.length : 0;
      const badgeCountA = a.badges ? a.badges.length : 0;

      if (badgeCountB !== badgeCountA) {
        return badgeCountB - badgeCountA;
      }
      return (b.points || 0) - (a.points || 0);
    });

    let rankingList = document.getElementById('badge-ranking-list');
    rankingList.innerHTML = '';
    
    allPlayers.slice(0, 10).forEach((player, index) => {
      const badgeCount = player.badges ? player.badges.length : 0;
      let li = document.createElement('li');
      li.innerHTML = `<strong>${index + 1}.</strong> <span class="player-name-link" onclick="showUserProfileDetails('${player.uid}')">${player.profile.name || player.username}</span> <span>(${badgeCount} insígnia${badgeCount !== 1 ? 's' : ''})</span>`;
      rankingList.appendChild(li);
    });
  }

  function showRanking(type) {
    const pointsView = document.getElementById('points-ranking-view');
    const badgesView = document.getElementById('badges-ranking-view');
    const pointsBtn = document.getElementById('rank-points-btn');
    const badgesBtn = document.getElementById('rank-badges-btn');

    if (type === 'points') {
      pointsView.classList.remove('hidden');
      badgesView.classList.add('hidden');
      pointsBtn.classList.add('active');
      badgesBtn.classList.remove('active');
      loadPointsLeaderboard();
    } else {
      pointsView.classList.add('hidden');
      badgesView.classList.remove('hidden');
      pointsBtn.classList.remove('active');
      badgesBtn.classList.add('active');
      loadBadgeLeaderboard();
    }
  }

  function togglePlayerList() {
    const playerList = document.getElementById('champ-details-players');
    const icon = document.getElementById('player-list-toggle-icon');
    
    const isHidden = playerList.classList.toggle('hidden');
    
    if (isHidden) {
      icon.innerText = '▼';
      icon.style.transform = 'rotate(0deg)';
    } else {
      icon.innerText = '▲';
      icon.style.transform = 'rotate(180deg)';
    }
  }

  async function toggleFeatureChampionship(champId, isCurrentlyFeatured) {
    const featureBtn = document.getElementById('feature-btn');
    featureBtn.disabled = true;
    try {
        await updateDoc(doc(db, 'championships', champId), {
            isFeatured: !isCurrentlyFeatured
        });
        await showChampionshipDetails(champId);
    } catch(e) {
        alert('Erro ao destacar torneio.');
    } finally {
        featureBtn.disabled = false;
    }
  }

  async function showChampionshipDetails(champId){
    document.getElementById('champ-details-players').classList.add('hidden');
    document.getElementById('player-list-toggle-icon').innerText = '▼';

    const views = document.querySelectorAll('.tab-content, #user-profile-details-view');
    views.forEach(view => view.classList.add('hidden'));
    document.getElementById('championship-details-view').classList.remove('hidden');

    const champDoc = await getDoc(doc(db, "championships", champId));
    if(!champDoc.exists()) return;

    const champ = champDoc.data();

    document.getElementById('champ-details-name').innerText = champ.name;
    document.getElementById('champ-details-status').innerText = champ.status;
    document.getElementById('champ-details-owner').innerText = allUsersData[champ.owner]?.profile.name || allUsersData[champ.owner]?.username || 'Desconhecido';
    document.getElementById('champ-details-date').innerText = champ.date;
    document.getElementById('champ-details-format').innerText = champ.format === 'bo3' ? 'Melhor de 3' : 'Eliminatória Simples';
    document.getElementById('champ-details-rules').innerText = champ.rules;
    
    const playersListElement = document.getElementById('champ-details-players');
    playersListElement.innerHTML = ''; 
    
    const user = allUsersData[currentUserId];
    const isOwner = currentUserId === champ.owner;
    const isAdmin = user && user.isAdmin;
    
    let playersHtml = '<ul>';
    champ.players.forEach(playerUid => {
      const playerName = allUsersData[playerUid]?.profile.name || allUsersData[playerUid]?.username || 'Carregando...';
      let removeButtonHtml = '';
      
      if ((isOwner || isAdmin) && currentUserId !== playerUid && champ.status === 'Open') {
        removeButtonHtml = `<button class="remove-player-btn" onclick="removePlayerFromChampionship('${champId}', '${playerUid}', '${playerName}')" title="Remover ${playerName}">ⓧ</button>`;
      }
      
      playersHtml += `<li><span>${playerName}</span> ${removeButtonHtml}</li>`;
    });
    playersHtml += '</ul>';
    playersListElement.innerHTML = playersHtml;

    document.getElementById('champ-details-count').innerText = champ.players.length;
    document.getElementById('champ-details-max').innerText = champ.max;

    const isPlayer = champ.players.includes(currentUserId);

    const joinBtn = document.getElementById('join-btn');
    const bracketBtn = document.getElementById('bracket-btn');
    const deleteBtn = document.getElementById('delete-btn');
    const featureBtn = document.getElementById('feature-btn');
    
    joinBtn.disabled = false;
    joinBtn.innerText = 'Entrar';

    joinBtn.classList.add('hidden');
    bracketBtn.classList.add('hidden');
    deleteBtn.classList.add('hidden');
    featureBtn.classList.add('hidden');

    if(isOwner || isAdmin){
      if (champ.status === 'Open') {
        bracketBtn.classList.remove('hidden');
        bracketBtn.onclick = () => drawBracket(champId);
      }
      deleteBtn.classList.remove('hidden');
      deleteBtn.onclick = () => deleteChampionship(champId);
      
      if(isAdmin) {
          featureBtn.classList.remove('hidden');
          featureBtn.innerText = champ.isFeatured ? '⭐ Remover Destaque' : '⭐ Destacar Torneio';
          featureBtn.onclick = () => toggleFeatureChampionship(champId, champ.isFeatured);
      }

    } else if (!isPlayer && champ.status === 'Open') {
      joinBtn.classList.remove('hidden');
      joinBtn.onclick = () => joinChampionship(champId);
    }

    const bracketContainer = document.getElementById('championship-bracket-container');
    bracketContainer.innerHTML = '';

    if(champ.rounds && champ.rounds.length > 0){
      let bracketDiv = document.createElement('div');
      bracketDiv.className = "bracket-container";
      bracketDiv.innerHTML = `<h3 class="bracket-heading">Chaveamento</h3>`;

      let roundsDiv = document.createElement('div');
      roundsDiv.className = "bracket-rounds";

      champ.rounds.forEach((round, i) => {
        let roundDiv = document.createElement('div');
        roundDiv.className = "bracket-round";
        
        let numBattles = round.matches.length;
        let roundTitle = "";
        if (numBattles > 4) roundTitle = `Rodada ${i + 1}`;
        else if (numBattles === 4) roundTitle = "Quartas de Final";
        else if (numBattles === 2) roundTitle = "Semifinais";
        else if (numBattles === 1) roundTitle = "Final";

        roundDiv.innerHTML = `<h4 class="round-heading">${roundTitle}</h4>`;

        round.matches.forEach((b, idx) => {
          let matchupDiv = document.createElement('div');
          matchupDiv.className = "bracket-matchup";
          
          const canSetWinner = !b.winner && (currentUserId === champ.owner || currentUserId === b.p1 || currentUserId === b.p2);
          const player1Name = allUsersData[b.p1]?.profile.name || allUsersData[b.p1]?.username;
          const player2Name = b.p2 === 'BYE' ? 'BYE' : (allUsersData[b.p2]?.profile.name || allUsersData[b.p2]?.username);
          
          let gamesHistoryHtml = '';
          if (champ.format === 'bo3' && b.games && b.games.length > 0) {
              gamesHistoryHtml = '<div class="games-history">';
              b.games.forEach((game, gameIndex) => {
                  const gameWinnerName = allUsersData[game.winner]?.username;
                  const replayLink = game.replay ? ` <a href="${game.replay}" target="_blank">(Replay)</a>` : '';
                  gamesHistoryHtml += `<div>Jogo ${gameIndex + 1}: ${gameWinnerName}${replayLink}</div>`;
              });
              gamesHistoryHtml += '</div>';
          } else if (b.replayLink) {
             let replayHtml = ` <a href="${b.replayLink}" target="_blank">(Replay)</a>`;
             gamesHistoryHtml = `<div class="games-history">${replayHtml}</div>`;
          }

          matchupDiv.innerHTML = `
            <div class="bracket-player ${b.winner === b.p1 ? 'is-winner' : (b.winner && b.winner !== b.p1) ? 'is-loser' : ''}">
              <span class="player-name-link" onclick="showUserProfileDetails('${b.p1}')">${player1Name}</span>
              ${canSetWinner ? `<span class="player-btn" onclick="showWinnerModal('${champId}',${i},${idx},'${b.p1}')">Vence</span>` : ''}
            </div>
            ${champ.format === 'bo3' ? `<div class="match-score">${b.p1Score} - ${b.p2Score}</div>` : ''}
            ${ b.p2 !== 'BYE' ? `
            <div class="bracket-player ${b.winner === b.p2 ? 'is-winner' : (b.winner && b.winner !== b.p2) ? 'is-loser' : ''}">
              <span class="player-name-link" onclick="showUserProfileDetails('${b.p2}')">${player2Name}</span>
              ${canSetWinner ? `<span class="player-btn" onclick="showWinnerModal('${champId}',${i},${idx},'${b.p2}')">Vence</span>` : ''}
            </div>` : ''}
            ${gamesHistoryHtml}
          `;
          roundDiv.appendChild(matchupDiv);
        });
        roundsDiv.appendChild(roundDiv);
      });
      bracketDiv.appendChild(roundsDiv);
      bracketContainer.appendChild(bracketDiv);
    }
  }

  function goBackToList(){
    showTab('all-tournaments');
  }

  async function loadAllUsersData() {
    const q = query(collection(db, "users"));
    const querySnapshot = await getDocs(q);
    allUsersData = {};
    querySnapshot.forEach(doc => {
        allUsersData[doc.id] = { uid: doc.id, ...doc.data() };
    });
  }

  // --- Funções do Painel Admin e Busca de Usuário ---

  async function loadAdminPanel() {
    const user = allUsersData[currentUserId];
    const userListDiv = document.getElementById('user-list-admin');
    userListDiv.innerHTML = '';
    
    if (user && user.isAdmin) {
        Object.values(allUsersData).forEach(userData => {
            if (userData.uid !== currentUserId) {
                let userCard = document.createElement('div');
                userCard.className = "champ-list-card";
                userCard.innerHTML = `
                    <h4>${userData.profile.name || userData.username}</h4>
                    <p>Usuário: ${userData.username}</p>
                    <p>Nível: ${userData.level || 1} | Pontos: ${userData.points || 0}</p>
                    <button onclick="banUser('${userData.uid}')">Excluir Usuário</button>
                `;
                userListDiv.appendChild(userCard);
            }
        });
    } else {
        userListDiv.innerHTML = '<p>Você não tem permissão para acessar esta página.</p>';
    }
  }

  async function banUser(uidToBan) {
      if (confirm(`Tem certeza que deseja excluir este usuário? Esta ação não pode ser desfeita.`)) {
          await deleteDoc(doc(db, "users", uidToBan));
          alert(`Usuário excluído do banco de dados.`);
          delete allUsersData[uidToBan];
          loadAdminPanel();
      }
  }
  
  const userSearchInput = document.getElementById('user-search-input');
  const searchResultsDiv = document.getElementById('search-results-list');
  userSearchInput.addEventListener('input', function(){
    const query = this.value.toLowerCase();
    searchResultsDiv.innerHTML = '';
    if (query.length < 2) return;
    
    const matches = Object.values(allUsersData).filter(user =>
      user.username.toLowerCase().includes(query) || (user.profile.name && user.profile.name.toLowerCase().includes(query))
    );

    matches.forEach(user => {
      const resultItem = document.createElement('div');
      resultItem.className = "search-result-item";
      resultItem.innerHTML = `<span>${user.profile.name || user.username}</span> <span>(Nível ${user.level || 1})</span>`;
      resultItem.onclick = () => showUserProfileDetails(user.uid);
      searchResultsDiv.appendChild(resultItem);
    });
  });

  async function showUserProfileDetails(uid) {
    viewingUserUid = uid;

    const user = allUsersData[uid];
    if (!user) {
        console.error("Usuário não encontrado no cache.");
        return;
    }
    const tabs = document.querySelectorAll('.tab-content, #championship-details-view');
    tabs.forEach(tab => tab.classList.add('hidden'));
    document.getElementById('user-profile-details-view').classList.remove('hidden');

    document.getElementById('other-user-card-name').innerText = user.profile.name || user.username;
    document.getElementById('other-user-card-image').src = user.profile.trainerImage || 'https://via.placeholder.com/120';
    document.getElementById('other-user-card-level').innerText = user.level || 1;
    document.getElementById('other-user-card-points').innerText = user.points || 0;
    document.getElementById('other-user-bio').innerText = user.profile.bio || 'Nenhuma biografia.';
    
    const socialsDiv = document.getElementById('other-user-socials');
    socialsDiv.innerHTML = '';
    if (user.profile.twitter) {
        const twitterLink = document.createElement('a');
        twitterLink.href = user.profile.twitter.startsWith('http') ? user.profile.twitter : `https://twitter.com/${user.profile.twitter}`;
        twitterLink.target = '_blank';
        twitterLink.innerText = `Twitter`;
        socialsDiv.appendChild(twitterLink);
    }
    if (user.profile.discord) {
        const discordP = document.createElement('p');
        discordP.innerHTML = `Discord: <strong>${user.profile.discord}</strong>`;
        socialsDiv.appendChild(discordP);
    }

    const statsDiv = document.getElementById('other-user-stats');
    statsDiv.innerHTML = `
      <div>
        <span class="stat-value">${user.wins || 0}V / ${user.losses || 0}D</span>
        <span class="stat-label">Vitórias/Derrotas</span>
      </div>
      <div>
        <span class="stat-value">${user.tournamentsPlayed || 0}</span>
        <span class="stat-label">Torneios</span>
      </div>
      <div>
        <span class="stat-value">${user.titlesWon || 0}</span>
        <span class="stat-label">Títulos</span>
      </div>
    `;

    const pokemonsContainer = document.getElementById('other-user-card-pokemons');
    pokemonsContainer.innerHTML = (user.profile.pokemons || []).map(p=>`
        <div class="pokemon-box">
            <img src="https://img.pokemondb.net/sprites/home/normal/${p.toLowerCase()}.png" alt="${p}">
        </div>
    `).join('');
    
    const badgesContainer = document.getElementById('other-badges-list');
    badgesContainer.innerHTML = '';
    const currentUser = allUsersData[currentUserId];
    const isAdmin = currentUser && currentUser.isAdmin;

    if(user.badges && user.badges.length > 0) {
        user.badges.forEach(badgeName => {
            const badgeDiv = document.createElement('div');
            badgeDiv.className = 'badge-item';
            badgeDiv.innerHTML = `🏆 ${badgeName}`;

            if(isAdmin) {
              const removeBtn = document.createElement('button');
              removeBtn.className = 'remove-badge-btn';
              removeBtn.innerHTML = 'ⓧ';
              removeBtn.title = `Remover insígnia ${badgeName}`;
              removeBtn.onclick = () => removeBadgeFromUser(badgeName);
              badgeDiv.appendChild(removeBtn);
            }

            badgesContainer.appendChild(badgeDiv);
        });
    }

    const addBadgeBtn = document.getElementById('add-badge-btn');
    if (isAdmin) {
      addBadgeBtn.classList.remove('hidden');
      addBadgeBtn.onclick = () => showBadgeModal();
    } else {
      addBadgeBtn.classList.add('hidden');
    }
  }

  function showBadgeModal() {
    const targetUser = allUsersData[viewingUserUid];
    if (!targetUser) return;

    const ownedBadges = targetUser.badges || [];
    const availableBadges = GYM_BADGES.filter(b => !ownedBadges.includes(b));
    
    const badgeListDiv = document.getElementById('badge-selection-list');
    badgeListDiv.innerHTML = '';

    if (availableBadges.length === 0) {
      badgeListDiv.innerHTML = '<p>Este jogador já possui todas as insígnias!</p>';
    } else {
      availableBadges.forEach(badgeName => {
        const badgeDiv = document.createElement('div');
        badgeDiv.className = 'badge-option';
        badgeDiv.innerText = `🏆 ${badgeName}`;
        badgeDiv.onclick = () => addBadgeToUser(badgeName);
        badgeListDiv.appendChild(badgeDiv);
      });
    }

    document.getElementById('badge-modal').classList.remove('hidden');
  }

  function hideBadgeModal() {
    document.getElementById('badge-modal').classList.add('hidden');
  }

  async function addBadgeToUser(badgeName) {
    if (!viewingUserUid) return;
    try {
      const userDocRef = doc(db, 'users', viewingUserUid);
      await updateDoc(userDocRef, {
        badges: arrayUnion(badgeName)
      });
      
      hideBadgeModal();
      await loadAllUsersData();
      await showUserProfileDetails(viewingUserUid);
    } catch (error) {
      console.error("Erro ao adicionar insígnia:", error);
      alert("Ocorreu um erro ao adicionar a insígnia.");
    }
  }

  async function removeBadgeFromUser(badgeName) {
    if (!viewingUserUid) return;
    const targetUser = allUsersData[viewingUserUid];
    const playerName = targetUser.profile.name || targetUser.username;
    if (confirm(`Tem certeza que deseja remover a insígnia "${badgeName}" de ${playerName}?`)) {
      try {
        const userDocRef = doc(db, 'users', viewingUserUid);
        await updateDoc(userDocRef, {
          badges: arrayRemove(badgeName)
        });
        await loadAllUsersData();
        await showUserProfileDetails(viewingUserUid);
      } catch (error) {
        console.error("Erro ao remover insígnia:", error);
        alert("Ocorreu um erro ao remover a insígnia.");
      }
    }
  }
  
  async function checkNotifications() {
      const user = allUsersData[currentUserId];
      if (user && user.notifications) {
          const unread = user.notifications.filter(n => !n.read);
          const bell = document.getElementById('notification-bell');
          if (unread.length > 0) {
              if (!bell.querySelector('.dot')) {
                  const dot = document.createElement('div');
                  dot.className = 'dot';
                  bell.appendChild(dot);
              }
          } else {
              if (bell.querySelector('.dot')) {
                  bell.querySelector('.dot').remove();
              }
          }
      }
  }

  async function showNotificationModal() {
      const user = allUsersData[currentUserId];
      const notificationList = document.getElementById('notification-list');
      notificationList.innerHTML = '';

      if (!user || !user.notifications || user.notifications.length === 0) {
          notificationList.innerHTML = '<p>Nenhuma notificação.</p>';
      } else {
          const sortedNotifications = [...user.notifications].sort((a, b) => b.timestamp.seconds - a.timestamp.seconds);
          
          sortedNotifications.forEach(notif => {
              const item = document.createElement('div');
              item.className = 'notification-item';
              item.innerText = notif.message;
              notificationList.appendChild(item);
          });

          const readNotifications = user.notifications.map(n => ({...n, read: true}));
          await updateDoc(doc(db, 'users', currentUserId), {
              notifications: readNotifications
          });
          await loadAllUsersData(); // Recarrega os dados do usuário para o cache
          checkNotifications(); // Remove o ponto vermelho
      }
      
      document.getElementById('notification-modal').classList.remove('hidden');
  }

  function hideNotificationModal() {
      document.getElementById('notification-modal').classList.add('hidden');
  }

  async function sendNotification(targetUid, message) {
      if (!targetUid) return;
      const userDocRef = doc(db, 'users', targetUid);
      const notification = {
          message: message,
          read: false,
          timestamp: new Date()
      };
      await updateDoc(userDocRef, {
          notifications: arrayUnion(notification)
      });
  }

  async function sendGlobalNotification() {
    const message = document.getElementById('global-notification-message').value.trim();
    if (!message) {
      alert("A mensagem não pode estar vazia.");
      return;
    }

    if (confirm(`Tem certeza que deseja enviar a seguinte mensagem para TODOS os usuários?\n\n"${message}"`)) {
      const sendButton = document.querySelector('#admin-panel-tab button[onclick="sendGlobalNotification()"]');
      sendButton.disabled = true;
      sendButton.innerText = 'Enviando...';

      try {
        const allUserIds = Object.keys(allUsersData);
        const notificationPromises = allUserIds.map(uid => sendNotification(uid, message));
        await Promise.all(notificationPromises);
        
        alert(`Notificação enviada com sucesso para ${allUserIds.length} usuários.`);
        document.getElementById('global-notification-message').value = '';
      } catch (error) {
        console.error("Erro ao enviar notificação global:", error);
        alert("Ocorreu um erro ao enviar as notificações.");
      } finally {
        sendButton.disabled = false;
        sendButton.innerText = 'Enviar para Todos';
      }
    }
  }


  // --- INICIALIZAÇÃO ---
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      await loadAllUsersData();
      await showUserScreen(user.uid);
    } else {
      currentUserId = null;
      allUsersData = {};
      document.getElementById('user-screen').classList.add('hidden');
      document.getElementById('login-screen').classList.remove('hidden');
    }
  });

  loadAllPokemons();

  // EXPOR FUNÇÕES PARA O ESCOPO GLOBAL (window)
  window.login = login;
  window.signup = signup;
  window.logout = logout;
  window.showTab = showTab;
  window.toggleEditProfile = toggleEditProfile;
  window.saveProfile = saveProfile;
  window.addPokemon = addPokemon;
  window.removePokemon = removePokemon;
  window.createChampionship = createChampionship;
  window.joinChampionship = joinChampionship;
  window.drawBracket = drawBracket;
  window.showWinnerModal = showWinnerModal;
  window.hideWinnerModal = hideWinnerModal;
  window.confirmWinner = confirmWinner;
  window.deleteChampionship = deleteChampionship;
  window.banUser = banUser;
  window.showChampionshipDetails = showChampionshipDetails;
  window.goBackToList = goBackToList;
  window.togglePlayerList = togglePlayerList;
  window.removePlayerFromChampionship = removePlayerFromChampionship;
  window.showUserProfileDetails = showUserProfileDetails;
  window.goBackFromProfile = goBackFromProfile;
  window.showBadgeModal = showBadgeModal;
  window.hideBadgeModal = hideBadgeModal;
  window.addBadgeToUser = addBadgeToUser;
  window.removeBadgeFromUser = removeBadgeFromUser;
  window.showRanking = showRanking;
  window.showNotificationModal = showNotificationModal;
  window.hideNotificationModal = hideNotificationModal;
  window.toggleFeatureChampionship = toggleFeatureChampionship;
  window.sendGlobalNotification = sendGlobalNotification;
</script>
</body>

</html>
